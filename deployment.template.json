{
  "moduleContent": {
    "$edgeAgent": {
      "properties.desired": {
        "schemaVersion": "1.0",
        "runtime": {
          "type": "docker",
          "settings": {
            "minDockerVersion": "v1.25",
            "loggingOptions": ""
          }
        },
        "systemModules": {
          "edgeAgent": {
            "type": "docker",
            "settings": {
              "image": "microsoft/azureiotedge-agent:1.0-preview",
              "createOptions": ""
            }
          },
          "edgeHub": {
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "settings": {
              "image": "microsoft/azureiotedge-hub:1.0-preview",
              "createOptions": ""
            }
          }
        },
        "modules": {
          "temp-sensor-module": {
            "version": "1.0",
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "settings": {
              "image": "microsoft/azureiotedge-simulated-temperature-sensor:1.0-preview",
              "createOptions": ""
            }
          },
          "filtermodule": {
            "version": "1.0",
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "settings": {
              "image": "${MODULES.filtermodule.amd64}",
              "createOptions": ""
            }
          },
          "filtermodule2": {
            "version": "1.0",
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "settings": {
              "image": "${MODULES.filtermodule2.amd64}",
              "createOptions": ""
            }
          },
          "filtermodule3": {
            "version": "1.0",
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "settings": {
              "image": "${MODULES.filtermodule3.amd64}",
              "createOptions": ""
            }
          },
          "functionmodule": {
            "version": "1.0",
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "settings": {
              "image": "${MODULES.functionmodule.amd64}",
              "createOptions": ""
            }
          }
        }
      }
    },
    "$edgeHub": {
      "properties.desired": {
        "schemaVersion": "1.0",
        "routes": {
          "sensorToFilter1": "FROM /messages/modules/temp-sensor-module/outputs/temperatureOutput INTO BrokeredEndpoint(\"/modules/filtermodule/inputs/input1\")",
          "filter2": "FROM /messages/modules/filtermodule/outputs/output1 INTO BrokeredEndpoint(\"/modules/filtermodule2/inputs/input1\")",
          "filter3": "FROM /messages/modules/filtermodule2/outputs/output1 INTO BrokeredEndpoint(\"/modules/filtermodule3/inputs/input1\")",
          "filterfunction": "FROM /messages/modules/filtermodule3/outputs/output1 INTO BrokeredEndpoint(\"/modules/functionmodule/inputs/input1\")",
          "filterToIoTHub": "FROM /messages/modules/functionmodule/outputs/output1 INTO $upstream"
        },
        "storeAndForwardConfiguration": {
          "timeToLiveSecs": 7200
        }
      }
    },
    "filtermodule": {
      "properties.desired": {
        "schemaVersion": "1.0",
        "TemperatureThreshold": 21
      }
    }
  }
}